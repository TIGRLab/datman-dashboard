
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Module contents &#8212; QC Dashboard 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Blueprints" href="dashboard.blueprints.html" />
    <link rel="prev" title="Dashboard API" href="modules.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-dashboard">
<span id="module-contents"></span><h1>Module contents<a class="headerlink" href="#module-dashboard" title="Permalink to this heading">¶</a></h1>
<p>Setup and initialization for the QC Dashboard.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dashboard.RegexConverter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.</span></span><span class="sig-name descname"><span class="pre">RegexConverter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url_map</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">items</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.RegexConverter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseConverter</span></code></p>
<p>A ‘regex’ type for URL routes.</p>
<p>For whatever reason Flask (as of this writing) does not appear to have a
built-in way to allow regular expressions in URL routes. RegexConverter
adds this capability. For more info see
<a class="reference external" href="https://stackoverflow.com/questions/5870188/does-flask-support-regular-expressions-in-its-url-routing">this post.</a></p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/someroute/&lt;regex(&quot;*.png&quot;):varname&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">some_view</span><span class="p">(</span><span class="n">varname</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This would add a URL endpoint for the pattern <code class="docutils literal notranslate"><span class="pre">/someroute/*.png</span></code>. The
part of the URL that matches the regex will be passed in to the view
without the prefix. e.g. accessing the URL ‘/someroute/my_picture.png’
would set varname to ‘my_picture.png’</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.configure_scheduler">
<span class="sig-prename descclassname"><span class="pre">dashboard.</span></span><span class="sig-name descname"><span class="pre">configure_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csrf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.configure_scheduler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.connect_db">
<span class="sig-prename descclassname"><span class="pre">dashboard.</span></span><span class="sig-name descname"><span class="pre">connect_db</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.connect_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Push an application context to allow external access to database models.</p>
<p>Anything that uses a flask extension, or accesses the app config, needs to
operate inside of an
<a class="reference external" href="https://flask.palletsprojects.com/en/1.1.x/appcontext/">application context.</a>
This function can be called to push the context.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.create_app">
<span class="sig-prename descclassname"><span class="pre">dashboard.</span></span><span class="sig-name descname"><span class="pre">create_app</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.create_app" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an application instance from the given configuration.</p>
<p>This will load the application configuration, initialize all extensions,
and register all blueprints.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.load_blueprints">
<span class="sig-prename descclassname"><span class="pre">dashboard.</span></span><span class="sig-name descname"><span class="pre">load_blueprints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.load_blueprints" title="Permalink to this definition">¶</a></dt>
<dd><p>Register all blueprints for the app.</p>
<p>A blueprint must be in the dashboard’s blueprint folder and must
implement the ‘register_bp’ function to be loaded by this function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.setup_devel_ext">
<span class="sig-prename descclassname"><span class="pre">dashboard.</span></span><span class="sig-name descname"><span class="pre">setup_devel_ext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.setup_devel_ext" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up extensions only used within development environments.</p>
</dd></dl>

</section>
<section id="submodules">
<h1>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h1>
<section id="module-dashboard.datman_utils">
<span id="dashboard-datman-utils-module"></span><h2>dashboard.datman_utils module<a class="headerlink" href="#module-dashboard.datman_utils" title="Permalink to this heading">¶</a></h2>
<p>Dashboard functionality that requires datman’s config module.</p>
<p>Some parts of the dashboard need datman.config to locate things on the file
system but datman.config uses the dashboard’s models. So to help prevent
circular references (and debug them when they happen) isolate all the
datman.config related code here.</p>
<p>This can safely be imported elsewhere but no dashboard related imports should
ever appear here</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This currently does not import correctly outside of an app context.</p>
</div>
<p>One consequence of this is that sphinx’s automodule can’t add it to the docs.
We have to solve the datman.config circular reference issues to fix this. :(</p>
<dl class="py function">
<dt class="sig sig-object py" id="dashboard.datman_utils.delete">
<span class="sig-prename descclassname"><span class="pre">dashboard.datman_utils.</span></span><span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.datman_utils.delete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.datman_utils.delete_bids">
<span class="sig-prename descclassname"><span class="pre">dashboard.datman_utils.</span></span><span class="sig-name descname"><span class="pre">delete_bids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.datman_utils.delete_bids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.datman_utils.delete_scan">
<span class="sig-prename descclassname"><span class="pre">dashboard.datman_utils.</span></span><span class="sig-name descname"><span class="pre">delete_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.datman_utils.delete_scan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.datman_utils.delete_session">
<span class="sig-prename descclassname"><span class="pre">dashboard.datman_utils.</span></span><span class="sig-name descname"><span class="pre">delete_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.datman_utils.delete_session" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.datman_utils.delete_timepoint">
<span class="sig-prename descclassname"><span class="pre">dashboard.datman_utils.</span></span><span class="sig-name descname"><span class="pre">delete_timepoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timepoint</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.datman_utils.delete_timepoint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.datman_utils.get_manifests">
<span class="sig-prename descclassname"><span class="pre">dashboard.datman_utils.</span></span><span class="sig-name descname"><span class="pre">get_manifests</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timepoint</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.datman_utils.get_manifests" title="Permalink to this definition">¶</a></dt>
<dd><p>Collects and organizes all QC manifest files for a timepoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timepoint</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dashboard.models.Timepoint</span></code>) – A timepoint from the
database.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A dictionary mapping session numbers to a dictionary of input nifti
files and their manifest contents.</p>
<p>For example:
{</p>
<blockquote>
<div><blockquote>
<div><dl class="simple">
<dt>1: {nifti_1: nifti_1_manifest,</dt><dd><p>nifti_2: nifti_2_manifest},</p>
</dd>
</dl>
<p>2: {nifti_3: nifti_3_manifest}</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.datman_utils.get_study_path">
<span class="sig-prename descclassname"><span class="pre">dashboard.datman_utils.</span></span><span class="sig-name descname"><span class="pre">get_study_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.datman_utils.get_study_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the full path to the study on the file system.</p>
<p>If folder is supplied and is defined in study config
then path to the folder is returned instead.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.datman_utils.read_json">
<span class="sig-prename descclassname"><span class="pre">dashboard.datman_utils.</span></span><span class="sig-name descname"><span class="pre">read_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.datman_utils.read_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a json file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_file</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The full path the the json file to load.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of the json contents or an error message.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.datman_utils.update_header_diffs">
<span class="sig-prename descclassname"><span class="pre">dashboard.datman_utils.</span></span><span class="sig-name descname"><span class="pre">update_header_diffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.datman_utils.update_header_diffs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-dashboard.emails">
<span id="dashboard-emails-module"></span><h2>dashboard.emails module<a class="headerlink" href="#module-dashboard.emails" title="Permalink to this heading">¶</a></h2>
<p>Functions for sending email notifications.</p>
<p>If an email message <strong>must</strong> be sent from the server side, and it isn’t used
exclusively by view functions (which only run on the server), then it needs to
be given to the scheduler. That means it needs a monitor and a check function.
To learn more about monitor/check functions see <a class="reference internal" href="#module-dashboard.monitors" title="dashboard.monitors"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dashboard.monitors</span></code></a></p>
<p>Any email notifications that might be submitted to the scheduler must only
receive arguments that are JSON serializable.
(<a class="reference external" href="https://docs.python.org/3/library/json.html#json.JSONEncoder">see here</a>
for info on serializable types).</p>
<dl class="py function">
<dt class="sig sig-object py" id="dashboard.emails.async_exec">
<span class="sig-prename descclassname"><span class="pre">dashboard.emails.</span></span><span class="sig-name descname"><span class="pre">async_exec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.emails.async_exec" title="Permalink to this definition">¶</a></dt>
<dd><p>Allow a given function to execute in the background.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.emails.missing_redcap_email">
<span class="sig-prename descclassname"><span class="pre">dashboard.emails.</span></span><span class="sig-name descname"><span class="pre">missing_redcap_email</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_emails</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.emails.missing_redcap_email" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify that a session that requires a REDCap survey did not receive one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> (<em>str</em>) – A session ID.</p></li>
<li><p><strong>study</strong> (<em>str</em><em>, </em><em>optional</em>) – The study that the session belongs to.</p></li>
<li><p><strong>dest_emails</strong> (str or <code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code> of str, optional) – Email address(es) to
relay the notification to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.emails.send_async_email">
<span class="sig-prename descclassname"><span class="pre">dashboard.emails.</span></span><span class="sig-name descname"><span class="pre">send_async_email</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">email</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.emails.send_async_email" title="Permalink to this definition">¶</a></dt>
<dd><p>Send an email in the background.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">flask.Flask</span></code>) – The current application instance.</p></li>
<li><p><strong>email</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">flask_mail.Message</span></code>) – The message to send.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.emails.send_email">
<span class="sig-prename descclassname"><span class="pre">dashboard.emails.</span></span><span class="sig-name descname"><span class="pre">send_email</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subject</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">html_body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recipient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.emails.send_email" title="Permalink to this definition">¶</a></dt>
<dd><p>Organize email contents into a message and send it in the background.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subject</strong> (<em>str</em>) – The subject line.</p></li>
<li><p><strong>body</strong> (<em>str</em>) – The plain text body of the email.</p></li>
<li><p><strong>html_body</strong> (<em>str</em><em>, </em><em>optional</em>) – An optional HTML formatted version of the
plain text body. Some email clients are plain text only. If the
recipient’s client can’t render HTML they will only receive the
plain text version.</p></li>
<li><p><strong>recipient</strong> (str or <code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code> of str, optional) – An email address (or
list of email address) to send the message to. If none is provided
the message will be sent to the address(es) configured as the
dashboard admin(s).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dashboard.exceptions">
<span id="dashboard-exceptions-module"></span><h2>dashboard.exceptions module<a class="headerlink" href="#module-dashboard.exceptions" title="Permalink to this heading">¶</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="dashboard.exceptions.InvalidDataException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.exceptions.</span></span><span class="sig-name descname"><span class="pre">InvalidDataException</span></span><a class="headerlink" href="#dashboard.exceptions.InvalidDataException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>An exception for attempts to add incorrect data to the database.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="dashboard.exceptions.InvalidUsage">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.exceptions.</span></span><span class="sig-name descname"><span class="pre">InvalidUsage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status_code</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">payload</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.exceptions.InvalidUsage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>An exception for incorrect usage of the URL endpoints.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.exceptions.InvalidUsage.status_code">
<span class="sig-name descname"><span class="pre">status_code</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">400</span></em><a class="headerlink" href="#dashboard.exceptions.InvalidUsage.status_code" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dashboard.exceptions.InvalidUsage.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.exceptions.InvalidUsage.to_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="dashboard.exceptions.MonitorException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.exceptions.</span></span><span class="sig-name descname"><span class="pre">MonitorException</span></span><a class="headerlink" href="#dashboard.exceptions.MonitorException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>An exception for scheduled jobs that have encountered problems.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="dashboard.exceptions.RedcapException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.exceptions.</span></span><span class="sig-name descname"><span class="pre">RedcapException</span></span><a class="headerlink" href="#dashboard.exceptions.RedcapException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>An exception for REDCap interface issues.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="dashboard.exceptions.SchedulerException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.exceptions.</span></span><span class="sig-name descname"><span class="pre">SchedulerException</span></span><a class="headerlink" href="#dashboard.exceptions.SchedulerException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>An exception for problems while interacting with the scheduler.</p>
</dd></dl>

</section>
<section id="module-dashboard.forms">
<span id="dashboard-forms-module"></span><h2>dashboard.forms module<a class="headerlink" href="#module-dashboard.forms" title="Permalink to this heading">¶</a></h2>
<p>Web forms used by the dashboard.</p>
<p>Forms are defined using the
` Flask-WTForms &lt;<a class="reference external" href="https://wtforms.readthedocs.io/en/latest/">https://wtforms.readthedocs.io/en/latest/</a>&gt;`_ extension. This
allows us to create HTML forms in python without having to worry writing HTML
or avoiding CSRF vulnerabilities.</p>
<dl class="py class">
<dt class="sig sig-object py" id="dashboard.forms.AnalysisForm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.forms.</span></span><span class="sig-name descname"><span class="pre">AnalysisForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.forms.AnalysisForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FlaskForm</span></code></p>
<p>Add a new analysis to the dashboard.</p>
<p>This feature has not yet been fully implemented.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.AnalysisForm.description">
<span class="sig-name descname"><span class="pre">description</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(TextAreaField,</span> <span class="pre">('Description',),</span> <span class="pre">{'validators':</span> <span class="pre">[&lt;wtforms.validators.DataRequired</span> <span class="pre">object&gt;]})&gt;</span></em><a class="headerlink" href="#dashboard.forms.AnalysisForm.description" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.AnalysisForm.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(TextField,</span> <span class="pre">('Brief</span> <span class="pre">name',),</span> <span class="pre">{'validators':</span> <span class="pre">[&lt;wtforms.validators.DataRequired</span> <span class="pre">object&gt;]})&gt;</span></em><a class="headerlink" href="#dashboard.forms.AnalysisForm.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.AnalysisForm.software">
<span class="sig-name descname"><span class="pre">software</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(TextAreaField,</span> <span class="pre">('Software',),</span> <span class="pre">{})&gt;</span></em><a class="headerlink" href="#dashboard.forms.AnalysisForm.software" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.forms.</span></span><span class="sig-name descname"><span class="pre">SelectMetricsForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.forms.SelectMetricsForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FlaskForm</span></code></p>
<p>Choose metrics from the database.</p>
<p>This form needs to be updated when we fix our QC metric integrations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.is_phantom">
<span class="sig-name descname"><span class="pre">is_phantom</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(HiddenField,</span> <span class="pre">(),</span> <span class="pre">{'default':</span> <span class="pre">False})&gt;</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.is_phantom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.metrictype_id">
<span class="sig-name descname"><span class="pre">metrictype_id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(SelectMultipleField,</span> <span class="pre">('Metric</span> <span class="pre">type',),</span> <span class="pre">{'coerce':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;})&gt;</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.metrictype_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.metrictype_vals">
<span class="sig-name descname"><span class="pre">metrictype_vals</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.metrictype_vals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.query_complete">
<span class="sig-name descname"><span class="pre">query_complete</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(HiddenField,</span> <span class="pre">(),</span> <span class="pre">{'default':</span> <span class="pre">False})&gt;</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.query_complete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.scan_id">
<span class="sig-name descname"><span class="pre">scan_id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(SelectMultipleField,</span> <span class="pre">('Scan',),</span> <span class="pre">{'coerce':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;})&gt;</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.scan_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.scan_vals">
<span class="sig-name descname"><span class="pre">scan_vals</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.scan_vals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.scantype_id">
<span class="sig-name descname"><span class="pre">scantype_id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(SelectMultipleField,</span> <span class="pre">('Scan</span> <span class="pre">type',),</span> <span class="pre">{'coerce':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;})&gt;</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.scantype_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.scantype_vals">
<span class="sig-name descname"><span class="pre">scantype_vals</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.scantype_vals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.session_id">
<span class="sig-name descname"><span class="pre">session_id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(SelectMultipleField,</span> <span class="pre">('Session',),</span> <span class="pre">{'coerce':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;})&gt;</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.session_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.session_vals">
<span class="sig-name descname"><span class="pre">session_vals</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.session_vals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.site_id">
<span class="sig-name descname"><span class="pre">site_id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(SelectMultipleField,</span> <span class="pre">('Site',),</span> <span class="pre">{'coerce':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;})&gt;</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.site_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.site_vals">
<span class="sig-name descname"><span class="pre">site_vals</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.site_vals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.study_id">
<span class="sig-name descname"><span class="pre">study_id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(SelectMultipleField,</span> <span class="pre">('Study',),</span> <span class="pre">{'coerce':</span> <span class="pre">&lt;class</span> <span class="pre">'int'&gt;})&gt;</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.study_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.SelectMetricsForm.study_vals">
<span class="sig-name descname"><span class="pre">study_vals</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#dashboard.forms.SelectMetricsForm.study_vals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dashboard.forms.StudyOverviewForm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.forms.</span></span><span class="sig-name descname"><span class="pre">StudyOverviewForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.forms.StudyOverviewForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">FlaskForm</span></code></p>
<p>Make edits to a study’s README form.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.StudyOverviewForm.readme_txt">
<span class="sig-name descname"><span class="pre">readme_txt</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(TextAreaField,</span> <span class="pre">('README',),</span> <span class="pre">{'id':</span> <span class="pre">'readme_editor'})&gt;</span></em><a class="headerlink" href="#dashboard.forms.StudyOverviewForm.readme_txt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dashboard.forms.StudyOverviewForm.study_id">
<span class="sig-name descname"><span class="pre">study_id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;UnboundField(HiddenField,</span> <span class="pre">(),</span> <span class="pre">{})&gt;</span></em><a class="headerlink" href="#dashboard.forms.StudyOverviewForm.study_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-dashboard.monitors">
<span id="dashboard-monitors-module"></span><h2>dashboard.monitors module<a class="headerlink" href="#module-dashboard.monitors" title="Permalink to this heading">¶</a></h2>
<p>Add and run scheduled jobs.</p>
<dl class="simple">
<dt>Each scheduled job requires two pieces:</dt><dd><ol class="arabic simple">
<li><p>A ‘check’ function that will run at the scheduled time and that does
the actual work.</p></li>
<li><p>A ‘monitor’ function that packages up the check function, any arguments
it needs, and a date/time and submits it to the server.</p></li>
</ol>
</dd>
</dl>
<p>Database queries can be made from within the check function to reduce the
number of arguments that must be passed. Remember also to use the check
function to verify that the scheduled task still makes sense to run at the
time it is executed. i.e. make sure data hasn’t been deleted, notifications are
still relevant, etc.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Any inputs submitted to the scheduler must be
<a class="reference external" href="https://docs.python.org/3/library/json.html#json.JSONEncoder">JSON serializable.</a>
Check functions, therefore, must only accept these types as input.</p>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="dashboard.monitors.add_monitor">
<span class="sig-prename descclassname"><span class="pre">dashboard.monitors.</span></span><span class="sig-name descname"><span class="pre">add_monitor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">check_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minutes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.monitors.add_monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a job to be run on the server at a scheduled time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>check_function</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">function</span></code>) – The function that will run at the
scheduled day and time.</p></li>
<li><p><strong>input_args</strong> (<em>Any</em>) – Arguments to pass to check_function at runtime</p></li>
<li><p><strong>input_kwargs</strong> (<em>Any</em><em>, </em><em>optional</em>) – Optional args to pass to check_function
at runtime.</p></li>
<li><p><strong>job_id</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – A unique identifier for the job</p></li>
<li><p><strong>days</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of days to add to the current time when
setting the run date.</p></li>
<li><p><strong>hours</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of hours to add to the current time when
setting the run date</p></li>
<li><p><strong>minutes</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of minutes to add to the current time
when setting the run date</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#dashboard.exceptions.SchedulerException" title="dashboard.exceptions.SchedulerException"><strong>dashboard.exceptions.SchedulerException</strong></a> – If the job cannot be
    added to the server.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The HTTP reply sent by the server</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.monitors.check_redcap">
<span class="sig-prename descclassname"><span class="pre">dashboard.monitors.</span></span><span class="sig-name descname"><span class="pre">check_redcap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recipients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.monitors.check_redcap" title="Permalink to this definition">¶</a></dt>
<dd><p>Emails a notification if the given session doesnt have a redcap record.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – A session name</p></li>
<li><p><strong>num</strong> (<em>int</em>) – A session number</p></li>
<li><p><strong>recipients</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – A list of email
address to notify.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#dashboard.exceptions.MonitorException" title="dashboard.exceptions.MonitorException"><strong>dashboard.exceptions.MonitorException</strong></a> – If a matching session
    can’t be found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.monitors.get_emails">
<span class="sig-prename descclassname"><span class="pre">dashboard.monitors.</span></span><span class="sig-name descname"><span class="pre">get_emails</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">users</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.monitors.get_emails" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a list of emails for the given users (without duplicates).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>users</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">dashboard.models.User</span></code>) – A list of users
to extract email addresses for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code> email address for each user.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.monitors.monitor_redcap_import">
<span class="sig-prename descclassname"><span class="pre">dashboard.monitors.</span></span><span class="sig-name descname"><span class="pre">monitor_redcap_import</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">users</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.monitors.monitor_redcap_import" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a scheduled job to run <a class="reference internal" href="#dashboard.monitors.check_redcap" title="dashboard.monitors.check_redcap"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_redcap()</span></code></a>.</p>
<p>This adds a scheduled job that will run <a class="reference internal" href="#dashboard.monitors.check_redcap" title="dashboard.monitors.check_redcap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_redcap</span></code></a> two days
after job submission and notify either the given list of users or all staff
contacts and study RAs if a redcap record has not found at that time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – A session name</p></li>
<li><p><strong>num</strong> (<em>int</em>) – A session number</p></li>
<li><p><strong>users</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">dashboard.models.User</span></code>, optional) – A list of users to notify</p></li>
<li><p><strong>study</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dashboard.models.Study</span></code>, optional) – The study to monitor
if the session belongs to more than one.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#dashboard.exceptions.MonitorException" title="dashboard.exceptions.MonitorException"><strong>dashboard.exceptions.MonitorException</strong></a> – If the ‘users’ argument
    was not set and no users are set as a staff contact or RA for the
    session’s study</p></li>
<li><p><a class="reference internal" href="#dashboard.exceptions.SchedulerException" title="dashboard.exceptions.SchedulerException"><strong>dashboard.exceptions.SchedulerException</strong></a> – If the job cannot
    be added to the server</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-dashboard.queries">
<span id="dashboard-queries-module"></span><h2>dashboard.queries module<a class="headerlink" href="#module-dashboard.queries" title="Permalink to this heading">¶</a></h2>
<p>Reusable database queries.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.find_scans">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">find_scans</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">search_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.find_scans" title="Permalink to this definition">¶</a></dt>
<dd><p>Used by the dashboard’s search bar and so must work around fuzzy user
input.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.find_sessions">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">find_sessions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">search_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.find_sessions" title="Permalink to this definition">¶</a></dt>
<dd><p>Used by the dashboard’s search bar and so must work around fuzzy user
input.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.find_subjects">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">find_subjects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">search_str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.find_subjects" title="Permalink to this definition">¶</a></dt>
<dd><p>Used by the dashboard’s search bar</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.get_redcap_config">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">get_redcap_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">project</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.get_redcap_config" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.get_scan">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">get_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timepoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.get_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Used by datman. Return a list of matching scans or an empty list</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.get_scan_qc">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">get_scan_qc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">approved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blacklisted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flagged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_phantoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.get_scan_qc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a set of QC records matching the given search terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>approved</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True scan QC records that have been
approved will be included in the result. Defaults to True.</p></li>
<li><p><strong>blacklisted</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True scan QC records that have been
blacklisted will be included in the result. Defaults to True.</p></li>
<li><p><strong>flagged</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True scan QC records that have been
flagged will be included in the result. Defaults to True.</p></li>
<li><p><strong>study</strong> (<em>str</em><em> or </em><em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em>) – A study ID or list of study IDs
to restrict the search to. Defaults to None.</p></li>
<li><p><strong>site</strong> (<em>str</em><em> or </em><em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em>) – A site ID or list of site IDs to
restrict the search to. Defaults to None.</p></li>
<li><p><strong>tag</strong> (<em>str</em><em> or </em><em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em>) – A tag or list of tags to restrict
the search to. Defaults to None.</p></li>
<li><p><strong>include_phantoms</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to include phantom QC
records in the result. Defaults to False.</p></li>
<li><p><strong>include_new</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to include scans that have
not yet been reviewed in the output. Defaults to False.</p></li>
<li><p><strong>comment</strong> (<em>str</em><em>, </em><em>optional</em>) – A semi-colon delimited list of QC comments
to search for. Defaults to None.</p></li>
<li><p><strong>user_id</strong> (<em>int</em><em>, </em><em>optional</em>) – The ID of a valid user. If this is given
the records returned will be restricted to those that the
user has permission to view. Note that this does not take into
account permissions for dashboard admins. That is, if the user
ID given is for a dashboard admin, the results will be overly
restrictive.</p></li>
<li><p><strong>sort</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to sort the results. Sorting is done
by scan name. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of tuples of the format</dt><dd><p>(scan name, status, comment), where ‘status’ is a boolean value
that represents whether the scan was approved or
flagged/blacklisted.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list(tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.get_scantypes">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">get_scantypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.get_scantypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all tags (or one specific tag) defined in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tag_id</strong> (<em>str</em><em>, </em><em>optional</em>) – A single tag to look up. Defaults to None.</p></li>
<li><p><strong>create</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to create a new record if tag_id
doesnt exist. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of Scantype records.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.get_session">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">get_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.get_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Used by datman. Return a specific session or None</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.get_studies">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">get_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.get_studies" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a study or studies based on search terms.</p>
<p>If no terms are provided all studies in the database will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of a specific study. If given other
search terms will be ignored. Defaults to None.</p></li>
<li><p><strong>tag</strong> (<em>str</em><em>, </em><em>optional</em>) – A study tag / code (e.g. SPN01) as found in the
first part of datman style subject IDs. Defaults to None.</p></li>
<li><p><strong>site</strong> (<em>str</em><em>, </em><em>optional</em>) – A site tag (e.g. CMH) as found in the second
part of datman style subject IDs. Defaults to None.</p></li>
<li><p><strong>create</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to create the study if it doesnt
exist. This option is ignored if ‘name’ isn’t provided.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of matching <code class="xref py py-obj docutils literal notranslate"><span class="pre">dashboard.models.Study</span></code> records. May</dt><dd><p>be empty if no matches found.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.get_study_timepoints">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">get_study_timepoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phantoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.get_study_timepoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains all timepoints from Studies model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>study</strong> – Study codename used in DATMAN</p></li>
<li><p><strong>site</strong> – Additionally apply a filter on the timepoints for a specific site</p></li>
<li><p><strong>phantoms</strong> – Optional argument to keep phantoms in record</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>[‘PACTMD_CMH_ABCD’, ‘PACTMD_CMH_DEFG’, … ]</p>
<p>If the site optional arugment is used, then only timepoints
belonging to site will be returned in a list</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of timepoint names from the specified study. For example</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.get_timepoint">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">get_timepoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bids_ses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.get_timepoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Used by datman. Return one timepoint or None</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.get_user">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">get_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">username</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.get_user" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.query_metric_types">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">query_metric_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.query_metric_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the database for metric types fitting the specifications</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.query_metric_values_byid">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">query_metric_values_byid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.query_metric_values_byid" title="Permalink to this definition">¶</a></dt>
<dd><p>Queries the database for metrics matching the specifications.
Arguments are lists of strings containing identifying names</p>
<p>Example:
rows = query_metric_value(Studies=[‘ANDT’,’SPINS’],</p>
<blockquote>
<div><p>ScanTypes=[‘T1’],
MetricTypes=[‘SNR’])</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.queries.query_metric_values_byname">
<span class="sig-prename descclassname"><span class="pre">dashboard.queries.</span></span><span class="sig-name descname"><span class="pre">query_metric_values_byname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.queries.query_metric_values_byname" title="Permalink to this definition">¶</a></dt>
<dd><p>Queries the database for metrics matching the specifications.
Arguments are lists of strings containing identifying names</p>
<p>Example:
rows = query_metric_value(Studies=[‘ANDT’,’SPINS’],</p>
<blockquote>
<div><p>ScanTypes=[‘T1’],
MetricTypes=[‘SNR’])</p>
</div></blockquote>
</dd></dl>

</section>
<section id="module-dashboard.task_scheduler">
<span id="dashboard-task-scheduler-module"></span><h2>dashboard.task_scheduler module<a class="headerlink" href="#module-dashboard.task_scheduler" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dashboard.task_scheduler.ContextThreadExecutor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.task_scheduler.</span></span><span class="sig-name descname"><span class="pre">ContextThreadExecutor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.task_scheduler.ContextThreadExecutor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ThreadPoolExecutor</span></code></p>
<p>Runs all scheduler jobs within the app context.</p>
<p>By default ThreadPoolExecutor does not propagate the app context correctly
when it submits jobs to its pool to execute. This class fixes the problem
by replacing the ‘run_job’ function submitted to the thread pool with
the ‘context_run’ wrapper which ensures a context has been pushed before
‘run_job’ executes.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dashboard.task_scheduler.RemoteScheduler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dashboard.task_scheduler.</span></span><span class="sig-name descname"><span class="pre">RemoteScheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.task_scheduler.RemoteScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A client scheduler that submits jobs to a scheduler server’s API.</p>
<p>This scheduler adds jobs via the dashboard server’s scheduler API instead
of directly interfacing with the job store. This is done to ensure that
all jobs run from the server side only and never from an instance
of the dashboard that has been imported.</p>
<p>If more of the scheduler API needs to be exposed a list of all built in end
points can found in flask_apscheduler/scheduler.py in
‘APScheduler._load_api’</p>
<dl class="py method">
<dt class="sig sig-object py" id="dashboard.task_scheduler.RemoteScheduler.add_job">
<span class="sig-name descname"><span class="pre">add_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_function</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.task_scheduler.RemoteScheduler.add_job" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dashboard.task_scheduler.RemoteScheduler.init_app">
<span class="sig-name descname"><span class="pre">init_app</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.task_scheduler.RemoteScheduler.init_app" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dashboard.task_scheduler.RemoteScheduler.start">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.task_scheduler.RemoteScheduler.start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.task_scheduler.context_run">
<span class="sig-prename descclassname"><span class="pre">dashboard.task_scheduler.</span></span><span class="sig-name descname"><span class="pre">context_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobstore_alias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.task_scheduler.context_run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.task_scheduler.disable_scheduler_csrf">
<span class="sig-prename descclassname"><span class="pre">dashboard.task_scheduler.</span></span><span class="sig-name descname"><span class="pre">disable_scheduler_csrf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csrf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.task_scheduler.disable_scheduler_csrf" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable csrf for scheduler views.</p>
<p>Enabling csrf for an app is a good idea, however the scheduler doesnt
use it and will raise ‘CSRF token not found’ errors if they arent
disabled for its views. This turns it off <em>only</em> for these views.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">flask.app.Flask</span></code>) – The current app object.</p></li>
<li><p><strong>csrf</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">flask_wtf.csrf.CSRFProtect</span></code>) – The initialized csrf object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.task_scheduler.format_job_function">
<span class="sig-prename descclassname"><span class="pre">dashboard.task_scheduler.</span></span><span class="sig-name descname"><span class="pre">format_job_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_function</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.task_scheduler.format_job_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-dashboard.utils">
<span id="dashboard-utils-module"></span><h2>dashboard.utils module<a class="headerlink" href="#module-dashboard.utils" title="Permalink to this heading">¶</a></h2>
<p>Helper functions for views.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dashboard.utils.dashboard_admin_required">
<span class="sig-prename descclassname"><span class="pre">dashboard.utils.</span></span><span class="sig-name descname"><span class="pre">dashboard_admin_required</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.utils.dashboard_admin_required" title="Permalink to this definition">¶</a></dt>
<dd><p>Verifies a user is a dashboard admin before granting access</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.utils.get_scan">
<span class="sig-prename descclassname"><span class="pre">dashboard.utils.</span></span><span class="sig-name descname"><span class="pre">get_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fail_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.utils.get_scan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.utils.get_session">
<span class="sig-prename descclassname"><span class="pre">dashboard.utils.</span></span><span class="sig-name descname"><span class="pre">get_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timepoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fail_url</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.utils.get_session" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.utils.get_timepoint">
<span class="sig-prename descclassname"><span class="pre">dashboard.utils.</span></span><span class="sig-name descname"><span class="pre">get_timepoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timepoint_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_user</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.utils.get_timepoint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.utils.is_safe_url">
<span class="sig-prename descclassname"><span class="pre">dashboard.utils.</span></span><span class="sig-name descname"><span class="pre">is_safe_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.utils.is_safe_url" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.utils.prev_url">
<span class="sig-prename descclassname"><span class="pre">dashboard.utils.</span></span><span class="sig-name descname"><span class="pre">prev_url</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.utils.prev_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the referring page if it is safe to do so, otherwise directs
the user to the index.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.utils.read_bool">
<span class="sig-prename descclassname"><span class="pre">dashboard.utils.</span></span><span class="sig-name descname"><span class="pre">read_bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.utils.read_bool" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a value to boolean.</p>
<p>bool(value) misreads “false”/”False” as True, so we use this instead
when parsing booleans from JSON requests.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.utils.report_form_errors">
<span class="sig-prename descclassname"><span class="pre">dashboard.utils.</span></span><span class="sig-name descname"><span class="pre">report_form_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">form</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.utils.report_form_errors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dashboard.utils.study_admin_required">
<span class="sig-prename descclassname"><span class="pre">dashboard.utils.</span></span><span class="sig-name descname"><span class="pre">study_admin_required</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dashboard.utils.study_admin_required" title="Permalink to this definition">¶</a></dt>
<dd><p>Verifies a user is a study admin or a dashboard admin. Any view function
this wraps must have ‘study_id’ as an argument</p>
</dd></dl>

</section>
</section>
<section id="subpackages">
<h1>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="dashboard.blueprints.html">Blueprints</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dashboard.blueprints.html#module-dashboard.blueprints">Module contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="dashboard.blueprints.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dashboard.blueprints.auth.html">dashboard.blueprints.auth package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.auth.html#module-dashboard.blueprints.auth">Module contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.auth.html#submodules">Submodules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.auth.html#module-dashboard.blueprints.auth.oauth">dashboard.blueprints.auth.oauth module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.auth.html#module-dashboard.blueprints.auth.views">dashboard.blueprints.auth.views module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dashboard.blueprints.handlers.html">dashboard.blueprints.handlers package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.handlers.html#module-dashboard.blueprints.handlers">Module contents</a><ul>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.handlers.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.handlers.html#module-dashboard.blueprints.handlers.views">dashboard.blueprints.handlers.views module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dashboard.blueprints.main.html">dashboard.blueprints.main package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.main.html#module-dashboard.blueprints.main">Module contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.main.html#submodules">Submodules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.main.html#module-dashboard.blueprints.main.views">dashboard.blueprints.main.views module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dashboard.blueprints.redcap.html">dashboard.blueprints.redcap package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.redcap.html#module-dashboard.blueprints.redcap">Module contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.redcap.html#submodules">Submodules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.redcap.html#module-dashboard.blueprints.redcap.emails">dashboard.blueprints.redcap.emails module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.redcap.html#module-dashboard.blueprints.redcap.monitors">dashboard.blueprints.redcap.monitors module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.redcap.html#module-dashboard.blueprints.redcap.utils">dashboard.blueprints.redcap.utils module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.redcap.html#module-dashboard.blueprints.redcap.views">dashboard.blueprints.redcap.views module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dashboard.blueprints.scans.html">dashboard.blueprints.scans package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.scans.html#submodules">Submodules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.scans.html#module-dashboard.blueprints.scans.forms">dashboard.blueprints.scans.forms module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.scans.html#module-dashboard.blueprints.scans.utils">dashboard.blueprints.scans.utils module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.scans.html#module-dashboard.blueprints.scans.views">dashboard.blueprints.scans.views module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.scans.html#module-dashboard.blueprints.scans">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dashboard.blueprints.timepoints.html">dashboard.blueprints.timepoints package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.timepoints.html#module-dashboard.blueprints.timepoints">Module contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.timepoints.html#submodules">Submodules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.timepoints.html#module-dashboard.blueprints.timepoints.emails">dashboard.blueprints.timepoints.emails module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.timepoints.html#module-dashboard.blueprints.timepoints.forms">dashboard.blueprints.timepoints.forms module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.timepoints.html#module-dashboard.blueprints.timepoints.utils">dashboard.blueprints.timepoints.utils module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.timepoints.html#module-dashboard.blueprints.timepoints.views">dashboard.blueprints.timepoints.views module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dashboard.blueprints.users.html">dashboard.blueprints.users package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.users.html#module-dashboard.blueprints.users">Module contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="dashboard.blueprints.users.html#submodules">Submodules</a><ul>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.users.html#module-dashboard.blueprints.users.forms">dashboard.blueprints.users.forms module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.users.html#module-dashboard.blueprints.users.utils">dashboard.blueprints.users.utils module</a></li>
<li class="toctree-l5"><a class="reference internal" href="dashboard.blueprints.users.html#module-dashboard.blueprints.users.views">dashboard.blueprints.users.views module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dashboard.models.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dashboard.models.html#module-dashboard.models">Module contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="dashboard.models.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dashboard.models.html#module-dashboard.models.emails">dashboard.models.emails module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard.models.html#module-dashboard.models.models">dashboard.models.models module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboard.models.html#module-dashboard.models.utils">dashboard.models.utils module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">QC Dashboard</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../menu_conf.html">Menu Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer Resources</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Dashboard API</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Module contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">Dashboard API</a><ul>
      <li>Previous: <a href="modules.html" title="previous chapter">Dashboard API</a></li>
      <li>Next: <a href="dashboard.blueprints.html" title="next chapter">Blueprints</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, TIGRLab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/api/dashboard.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>